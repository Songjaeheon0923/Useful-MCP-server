# 📝 Notion MCP Server

**패키지**: `@notionhq/notion-mcp-server`  
**GitHub**: [Notion MCP Server](https://github.com/notionhq/notion-mcp-server)  
**상태**: ✅ **연결됨**  

## 개요

Notion MCP Server는 Claude가 Notion 워크스페이스와 완전히 통합되어 페이지, 데이터베이스, 블록을 자유자재로 관리할 수 있게 해주는 공식 도구입니다. 콘텐츠 생성부터 복잡한 데이터베이스 쿼리까지 모든 Notion 작업을 자동화할 수 있습니다.

## 설치 및 설정

### 1. Notion 통합 생성

#### 통합 생성
1. [Notion Integrations](https://www.notion.so/my-integrations) 페이지 이동
2. **"New integration"** 클릭
3. 통합 정보 입력:
   - **Name**: "Claude MCP" (또는 원하는 이름)
   - **Logo**: 선택사항
   - **Associated workspace**: 사용할 워크스페이스 선택

#### 권한 설정
**Content Capabilities**:
- ✅ **Read content**: 페이지 및 데이터베이스 읽기
- ✅ **Update content**: 기존 내용 수정
- ✅ **Insert content**: 새로운 페이지/블록 생성

**Comment Capabilities**:
- ✅ **Read comments**: 댓글 읽기
- ✅ **Create comments**: 댓글 작성

#### 토큰 획득 및 환경 변수 설정
4. **Submit** 클릭하여 통합 생성
5. **Internal Integration Token** 복사 (secret_으로 시작)
6. 환경 변수로 토큰 설정:

```bash
# Windows에서 환경 변수 설정
setx NOTION_TOKEN "secret_your-notion-token-here"

# Linux/macOS
export NOTION_TOKEN="secret_your-notion-token-here"

# 영구 설정 (Linux/macOS)
echo 'export NOTION_TOKEN="secret_your-notion-token-here"' >> ~/.bashrc
source ~/.bashrc

# 설정 확인
echo %NOTION_TOKEN%  # Windows
echo $NOTION_TOKEN   # Linux/macOS
```

⚠️ **토큰을 공유하지 마세요!** 이 토큰으로 워크스페이스의 모든 연결된 페이지에 접근할 수 있습니다.

### 2. 워크스페이스 연결

<details>
<summary>🔗 워크스페이스 연결 가이드</summary>

#### 페이지별 연결
1. Notion에서 사용할 페이지나 데이터베이스 열기
2. 페이지 우상단 **"..."** (More) 메뉴 클릭
3. **"Add connections"** 또는 **"Connections"** 선택
4. 생성한 통합을 찾아 선택
5. 연결 완료

#### 전체 워크스페이스 연결 (관리자만)
- 워크스페이스 설정에서 통합을 전체 워크스페이스에 추가 가능
- 모든 페이지에 자동으로 접근 권한 부여

#### 데이터베이스 연결
- 데이터베이스 페이지에서도 동일한 방식으로 연결
- 연결된 데이터베이스는 쿼리, 생성, 수정 가능
</details>

### 3. MCP 서버 추가
```bash
# 환경 변수를 사용한 설치 (권장)
claude mcp add notion-server --scope user npx @notionhq/notion-mcp-server

# 또는 직접 토큰 지정 (덜 안전함)
claude mcp add notion-server --scope user npx @notionhq/notion-mcp-server -e NOTION_TOKEN=secret_YOUR_ACTUAL_TOKEN_HERE
```

**권장사항**: 환경 변수를 사용하면 명령어 이력에 토큰이 남지 않아 더 안전합니다.

### 4. 연결 확인
```bash
claude mcp list
# notion-server: npx @notionhq/notion-mcp-server - ✓ Connected 확인
```

## 주요 기능

### 📊 페이지 및 데이터베이스 관리
- **페이지 CRUD**: 페이지 생성, 읽기, 수정, 삭제
- **데이터베이스 쿼리**: 복잡한 필터링 및 정렬 조건으로 데이터 검색
- **블록 관리**: 텍스트, 이미지, 표, 코드 블록 등 추가/편집
- **속성 관리**: 제목, 태그, 날짜, 체크박스 등 다양한 속성 처리

### 🔍 검색 및 분석
- **전체 텍스트 검색**: 워크스페이스 전체에서 콘텐츠 검색
- **메타데이터 추출**: 페이지 생성일, 수정일, 작성자 정보
- **관계 분석**: 페이지 간 연결 및 백링크 추적
- **댓글 시스템**: 페이지 댓글 읽기 및 작성

### 📝 콘텐츠 생성 자동화
- **템플릿 기반 페이지 생성**: 일관된 형식의 문서 자동 생성
- **bulk 작업**: 여러 페이지/항목을 한 번에 처리
- **데이터 동기화**: 외부 소스에서 Notion으로 데이터 자동 동기화
- **워크플로우 자동화**: 조건부 업데이트 및 알림

## 사용 가능한 도구들

### 사용자 관리
- **`API-get-users`**: 워크스페이스 사용자 목록 조회
- **`API-get-user`**: 특정 사용자 정보 조회
- **`API-get-self`**: 현재 봇 사용자 정보 조회

### 검색 기능
- **`API-post-search`**: 제목으로 페이지/데이터베이스 검색

### 페이지 관리
- **`API-retrieve-a-page`**: 페이지 내용 및 속성 조회
- **`API-patch-page`**: 페이지 속성 업데이트
- **`API-post-page`**: 새 페이지 생성

### 블록 관리
- **`API-get-block-children`**: 블록의 하위 콘텐츠 조회
- **`API-patch-block-children`**: 블록에 새로운 콘텐츠 추가
- **`API-retrieve-a-block`**: 특정 블록 정보 조회
- **`API-update-a-block`**: 블록 내용 수정
- **`API-delete-a-block`**: 블록 삭제

### 데이터베이스 관리
- **`API-post-database-query`**: 데이터베이스 쿼리 (필터링, 정렬)
- **`API-create-a-database`**: 새 데이터베이스 생성
- **`API-update-a-database`**: 데이터베이스 구조 수정
- **`API-retrieve-a-database`**: 데이터베이스 정보 조회

### 댓글 시스템
- **`API-retrieve-a-comment`**: 페이지 댓글 조회
- **`API-create-a-comment`**: 새 댓글 작성

### 속성 관리
- **`API-retrieve-a-page-property`**: 페이지 속성값 조회

## 사용 예시

### 기본 콘텐츠 관리
```bash
# Claude에서 사용 예시:
"내 Notion 워크스페이스에서 '프로젝트' 데이터베이스의 모든 항목을 보여주세요"
"새로운 회의록 페이지를 생성하고 오늘 날짜로 설정해주세요"
"'개발' 태그가 있는 모든 페이지를 찾아서 우선순위별로 정렬해주세요"
"이 페이지에 새로운 할 일 체크리스트를 추가해주세요"
"지난주에 수정된 모든 문서를 찾아주세요"
```

### 고급 데이터베이스 작업
```bash
"이번 달 마감인 모든 작업을 찾아서 진행률별로 그룹화해주세요"
"완료되지 않은 작업 중 우선순위가 높은 것들을 담당자별로 정리해주세요"
"프로젝트 데이터베이스에서 예산이 초과된 항목들을 찾아주세요"
"고객별 미팅 이력을 시간순으로 정리해주세요"
```

### 자동화된 리포팅
```bash
"주간 팀 성과 보고서를 자동으로 생성해주세요"
"이번 달 목표 달성률을 계산해서 대시보드를 업데이트해주세요"
"고객 피드백을 분석해서 요약 리포트를 만들어주세요"
"프로젝트 진행 상황을 시각적으로 정리한 페이지를 만들어주세요"
```

### 콘텐츠 생성 및 관리
```bash
"이 템플릿을 사용해서 10개의 새로운 제품 페이지를 생성해주세요"
"블로그 게시물 초안을 작성하고 검토 요청 댓글을 추가해주세요"
"FAQ 페이지를 업데이트하고 새로운 질문들을 추가해주세요"
"팀 온보딩 체크리스트를 업데이트해주세요"
```

## 자동화 워크플로우 예시

### 📊 프로젝트 관리 자동화
- **일일 스탠드업 리포트**: 어제 완료, 오늘 계획, 블로커 자동 수집
- **주간 진행률 대시보드**: 프로젝트별 완료율, 일정 준수율 자동 계산
- **마일스톤 추적**: 중요 일정 접근 시 자동 알림 및 상태 업데이트
- **리소스 계획**: 팀 워크로드 분석 및 리소스 재배치 제안

### 📈 비즈니스 인텔리전스
- **고객 관계 관리**: 고객 상호작용 기록 자동 업데이트
- **영업 파이프라인**: 리드 진행 상황 추적 및 예측
- **재무 추적**: 예산 대비 실적 모니터링 및 알림
- **성과 메트릭**: KPI 자동 계산 및 트렌드 분석

### 🔄 운영 효율화
- **문서 관리**: 문서 버전 관리, 리뷰 주기 추적
- **지식 베이스**: 새로운 정보 자동 분류 및 태깅
- **회의 관리**: 회의록 템플릿 자동 생성, 액션 아이템 추적
- **온보딩 자동화**: 신입 직원 온보딩 체크리스트 진행 추적

### 📝 콘텐츠 워크플로우
- **편집 파이프라인**: 콘텐츠 상태별 자동 분류 및 알림
- **퍼블리싱 자동화**: 승인된 콘텐츠 자동 게시 및 배포
- **SEO 최적화**: 메타데이터 자동 생성 및 최적화 제안
- **번역 관리**: 다국어 콘텐츠 버전 관리 및 동기화

## 고급 사용법

### 복잡한 데이터베이스 쿼리
```bash
# 다중 조건 필터링
"상태가 '진행 중'이고 우선순위가 '높음'이며 담당자가 '김철수'인 작업을 찾아주세요"

# 날짜 범위 쿼리
"지난 30일 동안 생성된 페이지 중 '마케팅' 태그가 있는 것들을 날짜순으로 정렬해주세요"

# 관계형 데이터 조회
"이 고객과 관련된 모든 프로젝트, 회의, 계약을 시간순으로 정리해주세요"
```

### 동적 콘텐츠 생성
```bash
# 조건부 콘텐츠
"만약 프로젝트 진행률이 90% 이상이면 완료 준비 체크리스트를 추가해주세요"

# 템플릿 기반 생성
"고객 정보를 바탕으로 맞춤형 제안서를 자동 생성해주세요"

# 데이터 연동
"외부 API에서 데이터를 가져와서 Notion 데이터베이스를 업데이트해주세요"
```

### 협업 기능 활용
```bash
# 자동 할당
"신규 작업을 팀원들의 현재 워크로드를 고려해서 자동 할당해주세요"

# 리뷰 요청
"이 문서가 완성되면 관련 팀원들에게 자동으로 리뷰 요청 댓글을 추가해주세요"

# 진행 상황 공유
"프로젝트 상태 변경 시 관련자들에게 자동 알림을 보내주세요"
```

## 데이터베이스 속성 타입

### 기본 속성
- **Title**: 제목 (각 페이지당 하나만)
- **Rich Text**: 서식 있는 텍스트
- **Number**: 숫자
- **Select**: 단일 선택
- **Multi-select**: 다중 선택
- **Date**: 날짜/시간
- **Checkbox**: 체크박스
- **URL**: 웹 링크
- **Email**: 이메일 주소
- **Phone**: 전화번호

### 고급 속성
- **People**: 사용자 태그
- **Files & Media**: 파일 첨부
- **Relation**: 다른 데이터베이스와의 관계
- **Rollup**: 관련 데이터베이스에서 값 계산
- **Formula**: 수식으로 자동 계산
- **Created Time**: 생성 시간 (자동)
- **Created By**: 생성자 (자동)
- **Last Edited Time**: 최종 수정 시간 (자동)
- **Last Edited By**: 최종 수정자 (자동)

## 블록 타입 활용

### 텍스트 블록
- **Paragraph**: 일반 텍스트
- **Heading 1, 2, 3**: 제목
- **Bulleted List**: 불릿 리스트
- **Numbered List**: 번호 리스트
- **To-do**: 체크리스트
- **Toggle**: 접기/펼치기

### 미디어 블록
- **Image**: 이미지
- **Video**: 비디오
- **File**: 파일 첨부
- **Embed**: 외부 콘텐츠 임베드

### 고급 블록
- **Code**: 코드 블록
- **Quote**: 인용문
- **Callout**: 강조 박스
- **Table**: 표
- **Divider**: 구분선
- **Bookmark**: 웹 링크 프리뷰

## 성능 최적화

### 효율적인 쿼리
```bash
# 페이지 크기 제한
"처음 50개 결과만 가져와서 성능을 최적화해주세요"

# 필요한 속성만 조회
"제목과 상태 속성만 가져와서 빠르게 목록을 만들어주세요"

# 인덱스 활용
"데이터베이스의 정렬된 속성을 활용해서 빠르게 검색해주세요"
```

### 배치 처리
```bash
# 대량 데이터 처리
"100개의 페이지를 한 번에 업데이트하지 말고 10개씩 나누어 처리해주세요"

# 병렬 처리
"여러 데이터베이스를 동시에 쿼리해서 결과를 통합해주세요"
```

## 보안 및 권한 관리

### 접근 제어
- 통합은 명시적으로 연결된 페이지/데이터베이스에만 접근 가능
- 사용자 권한을 상속하지 않으므로 별도 권한 설정 필요
- 민감한 정보가 포함된 페이지는 개별적으로 접근 권한 관리

### 데이터 보호
- 토큰은 환경 변수로 관리하고 코드에 하드코딩 금지
- 정기적인 토큰 순환 (rotation) 고려
- 불필요한 권한은 비활성화

### 감사 로그
- Notion 워크스페이스 설정에서 활동 로그 확인
- API 사용량 모니터링
- 비정상적인 활동 패턴 감시

## 문제 해결

### 인증 오류
```bash
# 토큰 유효성 확인
# Notion 통합 설정에서 토큰 상태 확인

# 권한 문제
# 페이지/데이터베이스에 통합이 연결되어 있는지 확인

# 토큰 재생성
# 새 토큰 생성 후 환경 변수 업데이트
```

### API 제한
- Notion API는 초당 3회 요청 제한
- 429 오류 시 자동 재시도 구현 권장
- 대량 작업 시 적절한 지연 시간 설정

### 데이터 동기화 이슈
- 페이지 ID가 변경되는 경우 대비
- 삭제된 페이지 참조 시 예외 처리
- 권한 변경으로 인한 접근 불가 상황 대응

## 참고 자료

- [Notion API Documentation](https://developers.notion.com/)
- [Notion Integration Guide](https://developers.notion.com/docs/getting-started)
- [Official Notion MCP Server](https://github.com/notionhq/notion-mcp-server)
- [Notion API Best Practices](https://developers.notion.com/docs/working-with-page-content)

---

**마지막 업데이트**: 2025-08-09  
**테스트 환경**: Windows, Claude CLI